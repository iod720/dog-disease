<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dog Disease Predictor</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        button { margin: 5px; padding: 10px; border: none; border-radius: 5px; cursor: pointer; background: #4CAF50; color: white; }
        button.selected { background: #2196F3; }
    </style>
</head>
<body>
    <h2>Dog Disease Prediction</h2>
    <div id="symptom-buttons"></div>
    <div>
        <h4>Selected Symptoms:</h4>
        <ul id="selected-list"></ul>
    </div>
    <button onclick="predictDisease()">Predict Disease</button>
    <p id="prediction-result"></p>

    <script>
        let selectedSymptoms = [];

        function loadInitialSymptoms() {
            fetch('/get_initial_symptoms')
                .then(res => res.json())
                .then(data => renderSymptoms(data.symptoms));
        }

        function renderSymptoms(symptoms) {
            const container = document.getElementById('symptom-buttons');
            container.innerHTML = '';
            symptoms.forEach(symptom => {
                const btn = document.createElement('button');
                btn.textContent = symptom;
                btn.onclick = () => toggleSymptom(symptom, btn);
                if (selectedSymptoms.includes(symptom)) btn.classList.add('selected');
                container.appendChild(btn);
            });
        }

        function toggleSymptom(symptom, btn) {
            if (selectedSymptoms.includes(symptom)) {
                selectedSymptoms = selectedSymptoms.filter(s => s !== symptom);
            } else {
                selectedSymptoms.push(symptom);
            }
            updateSelectedList();
            fetchFilteredSymptoms();
        }

        function updateSelectedList() {
            const list = document.getElementById('selected-list');
            list.innerHTML = '';
            selectedSymptoms.forEach(symptom => {
                const item = document.createElement('li');
                item.textContent = symptom;
                list.appendChild(item);
            });
        }

        function fetchFilteredSymptoms() {
            fetch('/get_filtered_symptoms', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ selected_symptoms: selectedSymptoms })
            })
            .then(res => res.json())
            .then(data => renderSymptoms(data.remaining_symptoms));
        }

        function predictDisease() {
            fetch('/predict', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ symptoms: selectedSymptoms })
            })
            .then(res => res.json())
            .then(data => {
                document.getElementById('prediction-result').textContent = "Predicted Disease: " + data.predicted_disease;
            });
        }

        loadInitialSymptoms();
    </script>
</body>
</html>
